
# ------------------------------------------------------------------------------------------
# # å¤šé‡æ´¾å‘
# ------------------------------------------------------------------------------------------

# ------------------------------------------------------------------------------------------
# **å¤šé‡æ´¾å‘**æ˜¯è¿™ç¯‡notebookè¦æ¢ç´¢çš„Juliaçš„ä¸€ä¸ªå…³é”®ç‰¹æ€§ã€‚
#
# å®ƒæœ‰åŠ©äºå¿«é€Ÿå¼€å‘ã€‚å®ƒä¹Ÿè®©è½¯ä»¶å¯æ‹“å±•ã€å¯è®¾è®¡å’Œæ›´å¥½æŠŠç©ã€‚
#
# å®ƒå¯èƒ½æ˜¯å¹¶è¡Œè®¡ç®—å–å¾—é‡å¤§çªç ´çš„é¢„å…†ã€‚
# ------------------------------------------------------------------------------------------

# ------------------------------------------------------------------------------------------
# 1. ç½—é©¬æ•°å­—
# 2. å‡½æ•°
# 3. å¹¶è¡Œè®¡ç®—
# ------------------------------------------------------------------------------------------

# ------------------------------------------------------------------------------------------
# ## 1. ç½—é©¬æ•°å­—ï¼ˆç©ç©ï¼‰
# ------------------------------------------------------------------------------------------

# ------------------------------------------------------------------------------------------
# æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ª**æ–°ç»“æ„**è¡¨ç¤ºç½—é©¬æ•°å­—ã€‚ä¸ºäº†æ–¹ä¾¿å†™ä»£ç ï¼Œæˆ‘ä»¬å°†åªè€ƒè™‘0åˆ°9ã€‚
#
# **ç»ƒä¹ **ï¼šæ‹“å±•åˆ°æ›´å¤§çš„æ•°å­—ã€‚ï¼ˆåˆ«å¿˜äº†ç½—é©¬æ•°å­—æ˜¯åè¿›åˆ¶è®¡æ•°ç³»ç»Ÿï¼ï¼‰
# ------------------------------------------------------------------------------------------

struct Roman
    n::Int
end

Base.show(io::IO, r::Roman) = print(io, 'â…°' + (r.n - 1) % 10 )  # æ¼‚äº®çš„æ˜¾ç¤ºï¼›'â…°'æ˜¯ä¸€ä¸ªUnicodeç½—é©¬æ•°å­—

# ------------------------------------------------------------------------------------------
# æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·åˆ›å»ºä¸€ä¸ªè¿™ä¸ªç±»å‹çš„å¯¹è±¡ï¼š
# ------------------------------------------------------------------------------------------

Roman(4)

typeof.([5 5.0 Roman(5) "Five" '5'  5//1])

# ------------------------------------------------------------------------------------------
# æƒ³ç”¨ç½—é©¬æ•°å­—æ¼‚äº®åœ°å±•ç¤ºçš„è¯ï¼š
# ------------------------------------------------------------------------------------------

x = [7 1 2 5 8 9]
Roman.(x)   # equivalent to map(Roman, x)  or  [Roman(w) for w in x]

# ------------------------------------------------------------------------------------------
# è¦æ˜¯èƒ½åƒæ™®é€šæ•°å­—é‚£æ ·ç»™ç½—é©¬æ•°å­—åšåŠ æ³•å°±å¥½äº†ï¼š
# ------------------------------------------------------------------------------------------

Roman(4) + Roman(5)

# ------------------------------------------------------------------------------------------
# ä½†Juliaä¸çŸ¥é“è¯¥æ€ä¹ˆåšã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡`import`å‡½æ•°`+`å¹¶æ‹“å±•å®ƒçš„å®šä¹‰æ¥æ•™Juliaç»™ç½—é©¬æ•°å­—åšåŠ æ³•ï¼š
# ------------------------------------------------------------------------------------------

import Base: +, *

+(a::Roman, b::Roman) = Roman(a.n + b.n)

Roman(4) + Roman(5)

# ------------------------------------------------------------------------------------------
# è¿™æ ·å°±ç»™å‡½æ•°`+`**æ·»åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•**ï¼š
# ------------------------------------------------------------------------------------------

methods(+)

import Base.*
*(i::Roman, j::Roman) = Roman(i.n * j.n)                     # Multiply like a Roman

Roman(3) * Roman(2)

Roman.(1:3) .* [Roman(1) Roman(2) Roman(3)]

# ------------------------------------------------------------------------------------------
# ä½†æ˜¯
# ------------------------------------------------------------------------------------------

Roman(3) * 2

# mytimesåŸºäºç±»å‹æ¥åˆ¤æ–­è¯¥åšä»€ä¹ˆï¼Œå¾ˆå¤æ‚
# ä¸è¦çº ç»“ï¼Œæ›´å¥½çš„æ–¹æ³•é©¬ä¸Šå°±æ¥
function mytimes(i,j)
  if isa(i,Roman) & isa(j,Number)
        return  fill(1, i.n, j)   # i by j matrix with ones
    elseif    isa(i,Number) & isa(j,Roman) 
        return "ğŸ˜„"^ (i*j.n)   #  i * j happy faces
    else
        return("I Don't know")
    end
end

mytimes(4,Roman(3)) # 12ä¸ªç¬‘è„¸

mytimes(Roman(4),3) # 4x3çš„å…¨1çŸ©é˜µ

# ------------------------------------------------------------------------------------------
# æœ€ç®€å•çš„å®ç°æ–¹å¼æ˜¯æ˜ç¡®å®šä¹‰ä¸€ä¸ª`Roman`å’Œä¸€ä¸ªæ•°å­—çš„ä¹˜æ³•ã€‚æˆ‘ä»¬å¯ä»¥æŒ‰æˆ‘ä»¬çš„æƒ³æ³•æ¥å®šä¹‰ï¼š
# ------------------------------------------------------------------------------------------

*(i::Number, j::Roman) = "ğŸ˜„"^ (i*j.n)        #  i * jä¸ªç¬‘è„¸

*(i::Roman, j::Number) =   fill(1, i.n, j)       # i * jçš„çŸ©é˜µ

3 * Roman(3) # 9ä¸ªç¬‘è„¸

Roman(3) * 5  # 3*5çš„å…¨1çŸ©é˜µ

t(x::Roman,y::Roman) = x.n * y.n

t(Roman(5),Roman(4))

# æ³¨æ„å®ƒçš„æ±‡ç¼–ä»£ç æ˜¯å¤šç´§å‡‘ï¼
@code_native t(Roman(2),Roman(4))

# ------------------------------------------------------------------------------------------
# ## å‡½æ•°
# ------------------------------------------------------------------------------------------

import Base: *, +, ^

*(Î±::Number,   g::Function) = x -> Î± * g(x)   # æ ‡é‡ä¹˜ä»¥å‡½æ•°

*(f::Function, Î»::Number)   = x -> f(Î» * x)   # Scale the argument

*(f::Function, g::Function) = x -> f(g(x))    # å¤åˆå‡½æ•°  -- æ»¥ç”¨ç¬¦å·ï¼  åœ¨Julia0.6ä¸­ä½¿ç”¨ \circ

^(f::Function, n::Integer) = n == 1 ? f : f*f^(n-1) # ä¸€ä¸ªé€šè¿‡é€’å½’ä¹˜æ³•å®ç°çš„å¤©çœŸçš„æ±‚å¹‚ç®—æ³•

+(f::Function, g::Function) = x -> f(x) + g(x)

# ------------------------------------------------------------------------------------------
# ä¸¾ä¸ªä¾‹å­ï¼Œå®šä¹‰æˆè¿™æ ·çš„æŒ‡æ•°å‡½æ•°
#
# $$\exp(x) = \sum_{n=0}^\infty \frac{1}{n!} x^n.$$
#
# æˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹æˆæ˜¯è¿™æ ·çš„å‡½æ•°ï¼š
#
# $$\exp = \sum_{n=0}^\infty \frac{1}{n!} \mathrm{pow}_n,$$
#
# å…¶ä¸­$\mathrm{pow}_n(x) = x^n$.
#
# ï¼ˆå¼€å§‹ç”¨æ•°å­—æ¨¡ç³Šç¬¦å·ï¼ï¼‰
# ------------------------------------------------------------------------------------------

pow(n) = x -> x^n

myexp = sum(1/factorial(big(n)) * pow(n) for n in 0:100)   # æ•ˆç‡ä½çš„æ³°å‹’çº§æ•°ï¼

[myexp(1); exp(1); exp(big(1))]

f = x -> x^2
f(10)

g = 3f
g(10)

(f^2)(10)  # å› ä¸ºæˆ‘ä»¬å·²ç»å®šä¹‰äº†å‡½æ•°ä¹˜æ³•ä¸ºç¬¦åˆå‡½æ•°

using Plots;
gr()

x = pi*(0:0.001:4)

plot(x, sin.(x),    c="black", label="Fun")
plot!(x, (12*sin).(x),    c="green", label="Num * Fun")
plot!(x, (sin*12).(x),    c="red", alpha=0.9, label="Fun * Num")
plot!(x, (5*sin*exp).(x), c="blue", alpha=0.2, label="Num * Fun * Fun")

plot([12*sin, sin*12, 5*sin*exp], 0:.01:4Ï€, Î±=[1 .9 .2], c=[:green :red :blue])

# ------------------------------------------------------------------------------------------
# <img src="https://lh4.googleusercontent.com/--z5eKJbB7sg/UffjL1iAd4I/AAAAAAAABOc/S_wDVyDOB
# fQ/gauss.jpg">
# ------------------------------------------------------------------------------------------

# ------------------------------------------------------------------------------------------
# ###  â€œæˆ‘å¾ˆè®¨åŒsin^2 phiï¼Œè™½ç„¶Laplaceç”¨è¿‡å®ƒï¼›åº”è¯¥è¦æ‹…å¿ƒsin^2
# phiå¯èƒ½ä¼šå¼•èµ·æ­§ä¹‰ï¼Œå¦‚æœè¯´sin(phi^2)å°±ä¸ä¼šæˆ–è€…è¯´å‡ ä¹ä¸ä¼šå¼•èµ·æ­§ä¹‰äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å†™(sin phi)^2ï¼Œè€Œä¸æ˜¯sin^2 phiï¼Œä»¥æ­¤ç±»æ¨sin^2
# phiåº”è¯¥æŒ‡çš„æ˜¯sin(sin phi)ã€‚â€ -- Gauss
# ------------------------------------------------------------------------------------------

x=(0:.01:2) * pi;

plot(x, (sin^2).(x), c="blue")     # ä¹˜æ–¹èƒ½å·¥ä½œï¼Œy=sin(sin(x))ï¼ŒGaussä¼šå¼€å¿ƒçš„ï¼
plot!(x, sin.(x).^2,  c="red")         

# ------------------------------------------------------------------------------------------
# # Exercise
# ------------------------------------------------------------------------------------------

h(a, b::Any) = "fallback"
h(a::Number, b::Number) = "a and b are both numbers"
h(a::Number, b) = "a is a number"
h(a, b::Number) = "b is a number"
h(a::Integer, b::Integer) = "a and b are both integers"

# è¯•ç€æŠŠç©h
